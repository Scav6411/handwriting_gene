## **IITISoC Project: Type In Your Handwriting**


### **Contents**
- [Environment Requirements](#Environment-Requirements)
- [Overview](#Overview)
- [Dataset](#Dataset)
- [Preview](#Preview)
- [Training](#Training)
- [Results and Accuracy Measures](#Results-and-Accuracy-measures)
- [Documentation](#Documentation)
- [References](#References)
- [Contributors](#Contributors)


### **Environment Requirements**
- Python 3
- Pytorch 2.0.1
- cv2 4.0.1


### **Overview**
This machine learning model learns and mimics personal handwriting style. The model is trained on a dataset of handwritten samples of a person and is capable of converting standard fonts into any given personâ€™s personalized handwriting. It generates handwritten text that closely resembles unique writing style for various applications. 

### **Dataset**
We have used IAM Offline Handwriting Dataset consisting of over 20,000 samples of handwriting of over 500 different authors. We have used the handwriting samples of 339 authors for training purpose and 159 for validation purpose. This dataset was used because of its easy availability and diverse handwriting styles that were required for the Handwriting Imitation model.
* [IAM Handwriting Database](https://fki.tic.heia-fr.ch/databases/iam-handwriting-database)
### **Preview**


**Handwriting Imitation Model Algorithm**


![alt text](https://drive.google.com/uc?id=1YB10pFRzCdrDuuYPy_YEzoSYFnQH5S9l) 


**Handwriting Transformers model:**
Handwriting Transformers model works on generating the handwritten text of the query text based on the input handwriting. Our model has been trained on the vast IAM Dataset to generate handwriting using transformers and GAN. Later we finetune the model weights according to the input handwriting to generate images that match the input


**Model architecture:**
The basic architecture of our GAN model is such that we have used transformer layers in our generator to do the encoding and decoding procedure. First of all we have cnn encoded images as input to the model which are converted to grayscale format and also padded.  Subsequently the images are converted to tensor. These images go to the transformer encoder which processes the image descriptors helps in refining and enhancing the features.  Then this goes to the transformer decoder layer where the query text is embedded with the input text.The query text is also encoded using the OCR Network encoder. Now this goes to the CNN decoder where the fake image generated by the generator is passed on to the discriminator and based on its feedback generator modifies its weights during the training.

### **Training**



| ![800 epochs](https://drive.google.com/uc?id=1QOLh2PFGc1lFKC8lhzz3Vn9jK3NDitSs) | ![2000 epochs](https://drive.google.com/uc?id=1IM-3PxTuzeZor1TAQLH8BONDcOdRHMX0) | 
|:--:|:--:|
|**800 epochs**| **2000 epochs**|

| ![4000 epochs](https://drive.google.com/uc?id=1KX5W1TbO92NtpVm8Vv29sLWE8hIoDHZp) | ![6000 epochs](https://drive.google.com/uc?id=1OIV8nFyF_YN9yoa9dNGl7VOLIf8qDBDd) |
|:--:|:--:|
|**4000 epochs**| **6000 epochs**|

| ![8000 epochs](https://drive.google.com/uc?id=1o1BBarrEQg-NV7LGc1qERaXetkm9WeKG) | ![10000 epochs](https://drive.google.com/uc?id=1nvCZKJqi_4x-mEhwEkAQj8vxs0RmSC6M) | 
|:--:|:--:|
|**8000 epochs**| **10000 epochs**|

### **Demo**

See the random handwriting generation model [here](https://colab.research.google.com/drive/1nFhHhf_yp1wRadgrMzG_bQk02AAmpiel?usp=sharing).


See the personalized handwriting generation model [here](https://colab.research.google.com/drive/1xL1LyM2Oo7i-Gyt3l4_Q9JJvSIfp_Lkh?usp=sharing).

Note:  Please change the runtime the runtime to GPU before running all the cells. For personalised handwriting upload your image and change its image path in the mentioned location.

### **App**

You can try our apps for both demo files and try out our features [here](https://drive.google.com/drive/folders/167v6vOH3nJAmEWW2t1ItxL1WtSzrpboh?usp=sharing).

### **Results and Accuracy Measures**
We have used FID Score as our metrics for the following model. Below are some of our results and their fid scores.

| ![Raina-Output](https://drive.google.com/uc?id=1CBEkAr_BH5SsHla8BOwURisYR7hm1Jjb) | ![Soham-Output](https://drive.google.com/uc?id=1X3Qn0g9WbebgZtSpzev8VJkR3W2C6Daw) |
|:--:|:--:|
|**FID SCORE IN VOCAB:113.253975**| **FID SCORE IN VOCAB:105.99905**|
|**FID SCORE OUT VOCAB:105.119934**| **FID SCORE OUT VOCAB:112.280205** |

### **Documentation**


See the [Handwriting Imitation document](https://docs.google.com/document/d/1W1V6E_oaW-kdgnyxmaCUYlse9DZ-fcS5OOG1o_BEMtI/edit) for full documentation on implementation of models and the website.


### **References**


* https://github.com/M4rt1nM4yr/HandwritingImitationDemo/blob/main/HandwritingTransformers
* https://github.com/ganji15/HiGANplus
* https://openaccess.thecvf.com/content/ICCV2021/papers/Bhunia_Handwriting_Transformers_ICCV_2021_paper.pdf
* https://github.com/JaidedAI/EasyOCRtr
* https://huggingface.co/docs/transformers/model_doc/trocr


### **Contributers**
- [@sohampandit](https://www.github.com/Scav6411)
- [@lovelybhardwaj](https://www.github.com/lovelybhardwaj)
- [@rishitmehrotra](https://www.github.com/mehrotrarishit)
- [@rainatathed](https://www.github.com/Raina-310304)












